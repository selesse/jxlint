apply plugin: 'application'

mainClassName = 'com.selesse.jxlintimpl.Main'

dependencies {
    compile project(":jxlint")
    compile project(":jxlint-cli")

    compile 'ch.qos.logback:logback-classic:1.1.2'
    compile 'com.github.javaparser:javaparser-core:3.1.4'
    testCompile project(':jxlint-assertj')
}

ext.rulesFile = new File(projectDir, "RULES.md")

task rules(dependsOn: jar) {
    inputs.file jar
    outputs.file rulesFile

    doLast {
        javaexec {
            def outStream = new FileOutputStream(rulesFile)
            standardOutput = outStream

            main = mainClassName
            classpath = sourceSets.main.runtimeClasspath
            args = ["--rules"]
        }
    }
}

assemble.dependsOn rules
